@using INMETRO.CIPP.WEB.Models
@model InspecoesGravadasModel


@{
    ViewBag.Title = "ConsultaInspecao";

}
@{
    if (IsPost)
    {
        if (Model.Mensagem.ExisteExcecao)
        {
            <div class="row">
                <div class="col-md-10 col-md-offset-1">

                    <div id="idConsultaInspecao" class="alert alert-danger alert-dismissable">
                        @Html.Partial("_BuscaInspecaoError", Model.Mensagem)

                    </div>
                </div>
            </div>
        }
    }
}

<div class="row">

    <div class="col-md-10 col-md-offset-1" style="padding-bottom:25px;">
        <h2 class="tituloSistema">
            Consultar Inspeções
        </h2>
        <hr />
   
        <form action="@Url.Action("ConsultaInspecao", "Inspecao")" class="form form-inline" id="download" method="post" novalidate="novalidate">

            <select id="combo">
                <option value="0">- Selecione -</option>
                <option value="1">CÓDIGO OIA-PP</option>
                <option value="2">Nº CIPP</option>
                <option value="3">DATA DA INSPECÃO</option>
                <option value="4">PLACA DE LICENCIAMENTO</option>
                <option value="4">Buscar Todos</option>
            </select>
            <input id="idConsultarPor" class="btn btn-primary bg-inverse" type="button" value="Consultar Por"/>
            

            <div id="idCodigoOia" class="form-group" style="margin-left: 25px">
                @Html.Label("CÓDIGO OIA-PP")
                @Html.TextBox("CodigoOia", null, new {@class = "form-control", maxlength = "4", onkeypress = "return onlyNos(event,this);", id = "idCodigoOia"})
            </div>
            <div id="idCipp" class="form-group" style="margin-left: 25px">
                @Html.Label("Nº CIPP")
                @Html.TextBox("CodigoCipp", null, new {@class = "form-control", maxlength = "7", onkeypress = "return onlyNos(event,this);", id = "idCipp"})
                @Html.ValidationMessage("CodigoCipp")
            </div>
            <div id="idDateInsp" class="form-group" style="margin-left: 25px">
                @Html.Label("Data da Inspeção")
                @Html.EditorFor(model => model.DownloadModel.DataInspecao, new { htmlAttributes = new { @class = "form-control datepicker " } })
                @Html.ValidationMessage("DataInspecao")
            </div>
            <div id="idPlaca" class="form-group" style="margin-left: 25px">
                @Html.Label("Placa de Licença")
                @Html.EditorFor(model => model.DownloadModel.PlacaLicenca, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessage("PlacaLicenca")
            </div>

            <input type="submit" class="btn btn-primary bg-primary" value="Buscar" title="Download" id="btnBuscar">
            <input type="reset" class="btn btn-basic" value="Limpar" title="Cancelar" id="Cancelar">
        </form>
    
    </div>
    <br />
    <br />
    <div class="col-md-10 col-md-offset-1">

        @if (Model != null)
        {

            foreach (var item in Model.Inspecoes)
            {
                if (item.CodigoOia != null)
                {
                    <div id="idConsultaInspecao">
                        @Html.Partial("_PartialConsultaInspecao", Model)
                    </div>
                    break;
                }
            }

        }

    </div>
</div>

 

<script>
    function onlyNos(e) {

        var charCode;
        if (window.event) {
            charCode = window.event.keyCode;
        } else if (e) {
            charCode = e.which;
        } else { return true; }

        if (charCode > 31 && (charCode < 48 || charCode > 57)) {

            return false;
        }
        return true;
    }
    
   
    $("#Cancelar").click(function () {
        $("#idCodigoOia").val("");
        $("#idCipp").val("");
        return false;
    });

    $("#idCodigoOia").hide();
    $("#idCipp").hide();
    $("#btnBuscar").hide();
    $("#Cancelar").hide();
    $("#idDateInsp").hide();
    $("#idPlaca").hide();

    $(document).ready(function(){ 
        $('#idConsultarPor').click(function(){ 
            

            switch ($('#combo :selected').text()) {
            case 'Nº CIPP':
                MostrarCodigoCipp();
                break;
            case 'CÓDIGO OIA-PP':
                MostrarCodigoOia();
                break;
            case 'DATA DA INSPECÃO':
                MostrarDataInsp();
                break;
            case 'PLACA DE LICENCIAMENTO':
                MostrarBuscarPlaca();
                break;
            case 'Buscar Todos':
                MostrarBuscarTodos();
                break;
            default:
            }
        });
    });

    function MostrarCodigoOia() {

        $("#idCodigoOia").show();
        $("#btnBuscar").show();
        $("#Cancelar").show();
        $("#idCipp").hide();
        $("#idDateInsp").hide();
        $("#idPlaca").hide();
        $("#btnBuscar").val('Buscar'); 

    }

    function MostrarCodigoCipp() {

        $("#idCipp").show();
        $("#btnBuscar").show();
        $("#Cancelar").show();
        $("#idCodigoOia").hide();
        $("#idDateInsp").hide();
        $("#idPlaca").hide();
        $("#btnBuscar").val('Buscar'); 
    }
    function MostrarDataInsp() {

        $("#idDateInsp").show();
        $("#btnBuscar").show();
        $("#Cancelar").show();
        $("#idCodigoOia").hide();
        $("#idCipp").hide();
        $("#btnBuscar").show();
        $("#idPlaca").hide();
        $("#btnBuscar").val('Buscar'); 
    }
    function MostrarBuscarPlaca() {

        $("#idCipp").hide();
        $("#idPlaca").show();
        $("#Cancelar").show();
        $("#idCodigoOia").hide();
        $("#btnBuscar").show();
        $("#btnBuscar").val('Buscar'); 
        $("#idDateInsp").hide();


    }

    function MostrarBuscarTodos() {

        $("#idCipp").hide();
        $("#btnBuscar").show();
        $("#Cancelar").hide();
        $("#idCodigoOia").hide();
        $("#btnBuscar").show();
        $("#idDateInsp").hide();
        $("#idPlaca").hide();
        $("#btnBuscar").val('Buscar Todas as Inspeções'); 


    }
    (document).ready(function() {  
        $("#DownloadModel.DataInspecao").datepicker({  
  
            dateFormat:"dd-mm-yy",  
            changeMonth :true,   
            changeYear: true   
  
        });  
    });
  
</script>
